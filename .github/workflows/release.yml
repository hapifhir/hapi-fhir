name: HAPI Release

on:
    workflow_dispatch:

jobs:
    normalize-version:
        runs-on: ubuntu-latest

        steps:
            - name: Checkout code
              uses: actions/checkout@v3

            - name: Set up JDK
              uses: actions/setup-java@v4
              with:
                  distribution: 'temurin'
                  java-version: '17'

            - name: Get Maven version
              id: get_version
              uses: ./.github/actions/get-project-version

            - name: Normalize Maven version
              id: normalize
              uses: ./.github/actions/normalize-project-version
              with:
                  version: ${{ steps.get_version.outputs.version }}

            - name: Print versions
              run: |
                  echo "Original VERSION = ${{ steps.get_version.outputs.version }}"
                  echo "Normalized VERSION = ${{ steps.normalize.outputs.normalized_version }}"

            - name: Check if Git tag already exists
              uses: ./.github/actions/check-git-tag-exists
              with:
                  version: ${{ steps.normalize.outputs.normalized_version }}
