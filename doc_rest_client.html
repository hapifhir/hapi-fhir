
<!DOCTYPE html>
<!--
 Generated by Apache Maven Doxia at 2016-08-30
 Rendered using Reflow Maven Skin 1.1.1 (http://andriusvelykis.github.io/reflow-maven-skin)
-->
<html  xml:lang="en" lang="en">

	<head>
		<meta charset="UTF-8" />
		<title>RESTful Client - HAPI FHIR</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="description" content="" />
		<meta name="author" content="James Agnew" />
		<meta http-equiv="content-language" content="en" />

		<link href="https://netdna.bootstrapcdn.com/bootswatch/2.3.2/united/bootstrap.min.css" rel="stylesheet" />
		<link href="./css/bootstrap-responsive.min.css" rel="stylesheet" />
		<link href="./css/bootswatch.css" rel="stylesheet" />
		<link href="./css/reflow-skin.css" rel="stylesheet" />


		<link href="./css/lightbox.css" rel="stylesheet" />

		<link href="./css/site.css" rel="stylesheet" />
		<link href="./css/print.css" rel="stylesheet" media="print" />

		<!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
		<!--[if lt IE 9]>
			<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
		<![endif]-->


		
<script src="syntaxhighlighter/shCore.js" type="text/javascript"></script>
<script src="syntaxhighlighter/shBrushJScript.js" type="text/javascript"></script>
<script src="syntaxhighlighter/shBrushJava.js" type="text/javascript"></script>
<script src="syntaxhighlighter/shBrushBash.js" type="text/javascript"></script>
<script src="syntaxhighlighter/shBrushXml.js" type="text/javascript"></script>
<link rel="stylesheet" href="syntaxhighlighter/shCore.css" type="text/css"/>
<link rel="stylesheet" href="syntaxhighlighter/shThemeDefault.css" type="text/css"/>
<link rel="shortcut icon" href="http://hapifhir.io/favicon.png"/>
<link rel="stylesheet" href="hapi.css" type="text/css"/>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css"/>
	</head>

	<body class="page-doc_rest_client project-hapi-fhir" data-spy="scroll" data-offset="60" data-target="#toc-scroll-target">

		<div class="navbar navbar-fixed-top">
			<div class="navbar-inner">
				<div class="container">
					<a class="btn btn-navbar" data-toggle="collapse" data-target="#top-nav-collapse">
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</a>
					<a class="brand" href="http://hapifhir.io/"><span class="color-highlight">HAPI</span> FHIR</a>
					<div class="nav-collapse collapse" id="top-nav-collapse">
						<ul class="nav pull-right">
							<li ><a href="download.html"  title="Download"><i class="fa fa-download"></i> Download</a></li>
							<li ><a href="./" title="GitHub Project">GitHub Project</a></li>
							<li class="dropdown active">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-book"></i>&nbsp;Documentation&nbsp;<b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li ><a href="docindex.html" title="Documentation Index">Documentation Index</a></li>
									<li ><a href="doc_intro.html" title="Introduction">Introduction</a></li>
									<li ><a href="doc_dstu2.html" title="DSTU3 Support / HL7.org Structures">DSTU3 Support / HL7.org Structures</a></li>
									<li class="dropdown-submenu ">
										<a href="doc_fhirobjects.html" title="The Data Model">The Data Model</a>
										<ul class="dropdown-menu">
											<li ><a href="doc_fhirobjects.html" title="Working with Resources">Working with Resources</a></li>
											<li ><a href="doc_resource_references.html" title="Resource References">Resource References</a></li>
											<li ><a href="doc_extensions.html" title="Profiles & Extensions">Profiles & Extensions</a></li>
											<li ><a href="doc_tags.html" title="Tags">Tags</a></li>
											<li ><a href="doc_validation.html" title="Validation">Validation</a></li>
											<li ><a href="doc_custom_structures.html" title="Custom Structures">Custom Structures</a></li>
										</ul>
									</li>
									<li class="dropdown-submenu active">
										<a href="" title="RESTful Client">RESTful Client</a>
										<ul class="dropdown-menu">
											<li class="active"><a href="" title="Fluent/Generic Client">Fluent/Generic Client</a></li>
											<li ><a href="doc_rest_client_annotation.html" title="Annotation Client">Annotation Client</a></li>
											<li ><a href="doc_rest_client_interceptor.html" title="Interceptors (client)">Interceptors (client)</a></li>
											<li ><a href="doc_rest_client_http_config.html" title="Client Configuration">Client Configuration</a></li>
											<li ><a href="doc_rest_client_examples.html" title="Client Examples">Client Examples</a></li>
											<li ><a href="doc_rest_client_alternate_provider.html" title="JAX-RS Client & Alternate HTTP Providers">JAX-RS Client & Alternate HTTP Providers</a></li>
										</ul>
									</li>
									<li class="dropdown-submenu ">
										<a href="doc_rest_server.html" title="RESTful Server">RESTful Server</a>
										<ul class="dropdown-menu">
											<li ><a href="doc_rest_server.html" title="Using RESTful Server">Using RESTful Server</a></li>
											<li ><a href="doc_rest_operations.html" title="RESTful Operations">RESTful Operations</a></li>
											<li ><a href="doc_narrative.html" title="Narrative Generator">Narrative Generator</a></li>
											<li ><a href="doc_rest_server_interceptor.html" title="Interceptors (server)">Interceptors (server)</a></li>
											<li ><a href="doc_rest_server_security.html" title="Security">Security</a></li>
											<li ><a href="doc_cors.html" title="CORS Support">CORS Support</a></li>
											<li ><a href="doc_server_tester.html" title="Web Testing UI">Web Testing UI</a></li>
											<li ><a href="doc_rest_server_jaxrs.html" title="JAX-RS Support">JAX-RS Support</a></li>
										</ul>
									</li>
									<li ><a href="doc_logging.html" title="Logging">Logging</a></li>
									<li ><a href="doc_rest_etag.html" title="ETags">ETags</a></li>
									<li ><a href="doc_jpa.html" title="JPA/Database Server">JPA/Database Server</a></li>
									<li ><a href="doc_android.html" title="Android Support">Android Support</a></li>
									<li class="dropdown-submenu ">
										<a href="apidocs/index.html" title="JavaDocs">JavaDocs</a>
										<ul class="dropdown-menu">
											<li ><a href="apidocs/index.html" title="Core API">Core API</a></li>
											<li ><a href="apidocs-dstu/index.html" title="Model API (DSTU1)">Model API (DSTU1)</a></li>
											<li ><a href="apidocs-dstu2/index.html" title="Model API (DSTU2)">Model API (DSTU2)</a></li>
											<li ><a href="apidocs-dstu3/index.html" title="Model API (DSTU3)">Model API (DSTU3)</a></li>
											<li ><a href="apidocs-jpaserver/index.html" title="JPA Server API">JPA Server API</a></li>
										</ul>
									</li>
									<li ><a href="doc_cli.html" title="Command Line Tool (hapi-fhir-cli)">Command Line Tool (hapi-fhir-cli)</a></li>
									<li ><a href="doc_tinder.html" title="Maven Plugin (hapi-tinder-plugin)">Maven Plugin (hapi-tinder-plugin)</a></li>
								</ul>
							</li>
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-support"></i>&nbsp;Get Help&nbsp;<b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li ><a href="https://groups.google.com/d/forum/hapi-fhir" title="Google Group (Ask Questions)" class="externalLink">Google Group (Ask Questions)</a></li>
									<li ><a href="issues" title="Issue Tracker (Report Bugs/Request Features)">Issue Tracker (Report Bugs/Request Features)</a></li>
									<li ><a href="hapi-fhir-faq.html" title="Frequently Asked Questions (FAQ)">Frequently Asked Questions (FAQ)</a></li>
								</ul>
							</li>
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Test Server <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li ><a href="http://fhirtest.uhn.ca" title="Public Test Server" class="externalLink">Public Test Server</a></li>
									<li ><a href="doc_vagrant.html" title="Vagrant Private Test Server">Vagrant Private Test Server</a></li>
								</ul>
							</li>
						</ul>
					</div><!--/.nav-collapse -->
				</div>
			</div>
		</div>

	<div class="container">

	<!-- Masthead
	================================================== -->

	<header>
		<div>
			<ul class="breadcrumb">
				<li><a href="index.html" title="HAPI FHIR">HAPI FHIR</a></li>
				<li  class="divider">/</li>
			<li><a href="docindex.html" title="Documentation">Documentation</a></li>
			<li  class="divider">/</li>
				<li>RESTful Client</li>
				<li class="publishDate version-date pull-right">Last Published: 2016-08-30</li>
				<li class="divider pull-right">|</li>
				<li class="projectVersion version-date pull-right">Version: 2.1-SNAPSHOT</li>
			</ul>
		</div>
	</header>

	<div class="main-body">
	<div class="row">
		<div class="span8">
			<div class="body-content">
<!-- The body of the document contains a number of sections --> 
<div class="section"> 
 <div class="page-header">
  <h2 id="Creating_a_RESTful_Client">Creating a RESTful Client</h2>
 </div> 
 <!-- <table class="pagenavlinks">
				<tr>
					<td>
						<a class="pagenavlinks" href="./docindex.html"><span class="fa fa-caret-square-o-up"></span> Documentation Index</a>
					</td>
				</tr>
			</table> --> 
 <p> HAPI provides a built-in mechanism for connecting to FHIR RESTful servers. The HAPI RESTful client is designed to be easy to set up and to allow strong compile-time type checking wherever possible. </p> 
 <p> There are two types of RESTful clients provided by HAPI: The Fluent/Generic client (described below) and the <a href="./doc_rest_client_annotation.html">Annotation</a> client. The generic client is simpler to use and generally provides the faster way to get started. The annotation-driven client relies on static binding to specific operations to give better compile-time checking against servers with a specific set of capabilities exposed. This second model takes more effort to use, but can be useful if the person defining the specific methods to invoke is not the same person who is using those methods. </p> 
</div> 
<div class="section"> 
 <h2 id="The_FluentGeneric_Client">The Fluent/Generic Client</h2> 
 <p> Creating a generic client simply requires you to create an instance of <tt>FhirContext</tt> and use that to instantiate a client. </p> 
 <p> The following example shows how to create a client, and a few operations which can be performed. </p> 
 <div class="source"> 
  <pre>      // We're connecting to a DSTU1 compliant server in this example
      FhirContext ctx = FhirContext.forDstu2();
      String serverBase = &quot;http://fhirtest.uhn.ca/baseDstu2&quot;;
      
      IGenericClient client = ctx.newRestfulGenericClient(serverBase);

      // Perform a search
      Bundle results = client
            .search()
            .forResource(Patient.class)
            .where(Patient.FAMILY.matches().value(&quot;duck&quot;))
            .returnBundle(ca.uhn.fhir.model.dstu2.resource.Bundle.class)
            .execute();

      System.out.println(&quot;Found &quot; + results.getEntry().size() + &quot; patients named 'duck'&quot;);
</pre> 
 </div> 
 <p> <b>Performance Tip: </b> Note that FhirContext is an expensive object to create, so you should try to keep an instance around for the lifetime of your application. It is thread-safe so it can be passed as needed. Client instances, on the other hand, are very inexpensive to create so you can create a new one for each request if needed (although there is no requirement to do so, clients are reusable and thread-safe as well). </p> 
 <div class="section"> 
  <h3 id="Fluent_Calls">Fluent Calls</h3> 
  <p> The generic client supports queries using a fluent interface which is inspired by the fantastic <a class="externalLink" href="http://ewoutkramer.github.io/fhir-net-api/client-search.html">.NET FHIR API</a>. The fluent interface allows you to construct powerful queries by chaining method calls together, leading to highly readable code. It also allows you to take advantage of intellisense/code completion in your favourite IDE. </p> 
  <p> Note that most fluent operations end with an <tt>execute()</tt> statement which actually performs the invocation. You may also invoke several configuration operations just prior to the execute() statement, such as <tt>encodedJson()</tt> or <tt>encodedXml()</tt>. </p> 
 </div> 
 <div class="section"> 
  <h3 id="SearchQuery_-_Type">Search/Query - Type</h3> 
  <p> Searching for resources is probably the most common initial scenario for client applications, so we'll start the demonstration there. The FHIR search operation generally uses a URL with a set of predefined search parameters, and returns a Bundle containing zero-or-more resources which matched the given search criteria. </p> 
  <p> Search is a very powerful mechanism, with advanced features such as paging, including linked resources, etc. See the FHIR <a class="externalLink" href="http://hl7.org/fhir/search.html">search specification</a> for more information. </p> 
  <p class="doc_info_bubble"> <b>Note on Bundle types: </b> As of DSTU2, FHIR defines Bundle as a resource instead of an Atom feed as it was in DSTU1. In code that was written for DSTU1 you would typically use the <tt>ca.uhn.fhir.model.api.Bundle</tt> class to represent a bundle, and that is that default return type for search methods. If you are implemeting a DSTU2+ server, is recommended to use a Bundle resource class instead (e.g. <tt>ca.uhn.fhir.model.dstu2.resource.Bundle</tt> or <tt>org.hl7.fhir.instance.model.Bundle</tt>). Many of the examples below include a chained invocation similar to <tt>.returnBundle(ca.uhn.fhir.model.dstu2.resource.Bundle.class)</tt>, which instructs the search method which bundle type should be returned. </p> 
  <p> The following example shows how to query using the generic client: </p> 
  <div class="source"> 
   <pre>ca.uhn.fhir.model.dstu2.resource.Bundle response = client.search()
      .forResource(Patient.class)
      .where(Patient.BIRTHDATE.beforeOrEquals().day(&quot;2011-01-01&quot;))
      .and(Patient.CAREPROVIDER.hasChainedProperty(Organization.NAME.matches().value(&quot;Health&quot;)))
      .returnBundle(ca.uhn.fhir.model.dstu2.resource.Bundle.class)
      .execute();
</pre> 
  </div> 
  <div class="section"> 
   <h4 id="Search_-_Multi-valued_Parameters_ANYOR">Search - Multi-valued Parameters (ANY/OR)</h4> 
   <p> To search for a set of possible values where <b>ANY</b> should be matched, you can provide multiple values to a parameter, as shown in the example below. This leads to a URL resembling <tt>?family=Smith,Smyth</tt> </p> 
   <div class="source"> 
    <pre>response = client.search()
      .forResource(Patient.class)
      .where(Patient.FAMILY.matches().values(&quot;Smith&quot;, &quot;Smyth&quot;))
      .returnBundle(Bundle.class)
      .execute();
</pre> 
   </div> 
  </div> 
  <div class="section"> 
   <h4 id="Search_-_Multi-valued_Parameters_ALLAND">Search - Multi-valued Parameters (ALL/AND)</h4> 
   <p> To search for a set of possible values where <b>ALL</b> should be matched, you can provide multiple instances of a marameter, as shown in the example below. This leads to a URL resembling <tt>?address=Toronto&amp;address=Ontario&amp;address=Canada</tt> </p> 
   <div class="source"> 
    <pre>response = client.search()
      .forResource(Patient.class)
      .where(Patient.ADDRESS.matches().values(&quot;Toronto&quot;))
      .and(Patient.ADDRESS.matches().values(&quot;Ontario&quot;))
      .and(Patient.ADDRESS.matches().values(&quot;Canada&quot;))
      .returnBundle(Bundle.class)
      .execute();
</pre> 
   </div> 
  </div> 
  <div class="section"> 
   <h4 id="Search_-_Paging">Search - Paging</h4> 
   <p> If the server supports paging results, the client has a page method which can be used to load subsequent pages. </p> 
   <div class="source"> 
    <pre>         FhirContext ctx = FhirContext.forDstu2();
         IGenericClient client = ctx.newRestfulGenericClient(&quot;http://fhirtest.uhn.ca/baseDstu2&quot;);
         
         // Perform a search
         Bundle results = client.search()
               .forResource(Patient.class)
               .where(Patient.NAME.matches().value(&quot;Smith&quot;))
               .returnBundle(Bundle.class)
               .execute();
         
         if (results.getLink(Bundle.LINK_NEXT) != null) {

            // load next page
            Bundle nextPage = client.loadPage().next(results).execute();
         }
</pre> 
   </div> 
  </div> 
  <div class="section"> 
   <h4 id="Search_-_Composite_Parameters">Search - Composite Parameters</h4> 
   <p> If a composite parameter is being searched on, the parameter takes a &quot;left&quot; and &quot;right&quot; operand, each of which is a parameter from the resource being seached. The following example shows the syntax. </p> 
   <div class="source"> 
    <pre>response = client.search()
      .forResource(&quot;Observation&quot;)
      .where(Observation.CODE_VALUE_DATE
            .withLeft(Observation.CODE.exactly().code(&quot;FOO$BAR&quot;))
            .withRight(Observation.VALUE_DATE.exactly().day(&quot;2001-01-01&quot;)))
      .returnBundle(Bundle.class)
      .execute();
</pre> 
   </div> 
  </div> 
  <div class="section"> 
   <h4 id="Search_-_By_plain_URL">Search - By plain URL</h4> 
   <p> You can also perform a search using a String URL, instead of using the fluent method calls to build the URL. This can be useful if you have a URL you retrieved from somewhere else that you want to use as a search. </p> 
   <div class="source"> 
    <pre>String searchUrl = &quot;http://example.com/base/Patient?identifier=foo&quot;;

// Search URL can also be a relative URL in which case the client's base
// URL will be added to it
searchUrl = &quot;Patient?identifier=foo&quot;;

response = client.search()
      .byUrl(searchUrl)
      .returnBundle(ca.uhn.fhir.model.dstu2.resource.Bundle.class)
      .execute();
</pre> 
   </div> 
  </div> 
  <div class="section"> 
   <h4 id="Search_-_Other_Query_Options">Search - Other Query Options</h4> 
   <p> The fluent search also has methods for sorting, limiting, specifying JSON encoding, _include, _revinclude, _lastUpdated, _tag, etc. </p> 
   <div class="source"> 
    <pre>response = client.search()
      .forResource(Patient.class)
      .encodedJson()
      .where(Patient.BIRTHDATE.beforeOrEquals().day(&quot;2012-01-22&quot;))
      .and(Patient.BIRTHDATE.after().day(&quot;2011-01-01&quot;))
      .withTag(&quot;http://acme.org/codes&quot;, &quot;needs-review&quot;)
      .include(Patient.INCLUDE_ORGANIZATION.asRecursive())
      .include(Patient.INCLUDE_CAREPROVIDER.asNonRecursive())
      .revInclude(Provenance.INCLUDE_TARGET)
      .lastUpdated(new DateRangeParam(&quot;2011-01-01&quot;, null))
      .sort().ascending(Patient.BIRTHDATE)
      .sort().descending(Patient.NAME).limitTo(123)
      .returnBundle(Bundle.class)
      .execute();
</pre> 
   </div> 
  </div> 
  <div class="section"> 
   <h4 id="Search_-_Using_HTTP_POST">Search - Using HTTP POST</h4> 
   <p> The FHIR specification allows the use of an HTTP POST to transmit a search to a server instead of using an HTTP GET. With this style of search, the search parameters are included in the request body instead of the request URL, which can be useful if you need to transmit a search with a large number of parameters. </p> 
   <p> The <tt>usingStyle()</tt> method controls which style to use. By default, GET style is used unless the client detects that the request would result in a very long URL (over 8000 chars) in which case the client automatically switches to POST. </p> 
   <p> An alternate form of the search URL (using a URL ending with<tt>_search</tt>) was also supported in FHIR DSTU1. This form is no longer valid in FHIR DSTU2, but HAPI retains support for using this form in order to interoperate with servers which use it. </p> 
   <div class="source"> 
    <pre>response = client.search()
      .forResource(&quot;Patient&quot;)
      .where(Patient.NAME.matches().value(&quot;Tester&quot;))
      .usingStyle(SearchStyleEnum.POST)
      .returnBundle(Bundle.class)
      .execute();
</pre> 
   </div> 
  </div> 
  <div class="section"> 
   <h4 id="Search_-_Compartments">Search - Compartments</h4> 
   <p> To search a <a class="externalLink" href="http://www.hl7.org/implement/standards/fhir/extras.html#compartment">resource compartment</a>, simply use the <tt>withIdAndCompartment</tt> method in your search. </p> 
   <div class="source"> 
    <pre>response = client.search()
      .forResource(Patient.class)
      .withIdAndCompartment(&quot;123&quot;, &quot;condition&quot;)
      .where(Patient.ADDRESS.matches().values(&quot;Toronto&quot;))
      .returnBundle(ca.uhn.fhir.model.dstu2.resource.Bundle.class)
      .execute();
</pre> 
   </div> 
  </div> 
  <div class="section"> 
   <h4 id="Search_-_Subsetting__summary_and__elements">Search - Subsetting (_summary and _elements)</h4> 
   <p> Sometimes you may want to only ask the server to include some parts of returned resources (instead of the whole resource). Typically this is for performance or optimization reasons, but there may also be privacy reasons for doing this. </p> 
   <p> To request that the server return only &quot;summary&quot; elements (those elements defined in the specification with the &quot;Î£&quot; flag), you can use the <tt>summaryMode(SummaryEnum)</tt> qualifier: </p> 
   <div class="source"> 
    <pre>response = client.search()
      .forResource(Patient.class)
      .where(Patient.ADDRESS.matches().values(&quot;Toronto&quot;))
      .returnBundle(ca.uhn.fhir.model.dstu2.resource.Bundle.class)
      .summaryMode(SummaryEnum.TRUE)
      .execute();
</pre> 
   </div> 
   <p> To request that the server return only elements from a custom list provided by the client, you can use the <tt>elementsSubset(String...)</tt> qualifier: </p> 
   <div class="source"> 
    <pre>response = client.search()
      .forResource(Patient.class)
      .where(Patient.ADDRESS.matches().values(&quot;Toronto&quot;))
      .returnBundle(ca.uhn.fhir.model.dstu2.resource.Bundle.class)
      .elementsSubset(&quot;identifier&quot;, &quot;name&quot;) // only include the identifier and name
      .execute();
</pre> 
   </div> 
  </div> 
 </div> 
 <div class="section"> 
  <h3 id="Create_-_Type">Create - Type</h3> 
  <p> The following example shows how to perform a create operation using the generic client: </p> 
  <div class="source"> 
   <pre>         Patient patient = new Patient();
         // ..populate the patient object..
         patient.addIdentifier().setSystem(&quot;urn:system&quot;).setValue(&quot;12345&quot;);
         patient.addName().addFamily(&quot;Smith&quot;).addGiven(&quot;John&quot;);

         // Invoke the server create method (and send pretty-printed JSON
         // encoding to the server
         // instead of the default which is non-pretty printed XML)
         MethodOutcome outcome = client.create()
            .resource(patient)
            .prettyPrint()
            .encodedJson()
            .execute();
         
         // The MethodOutcome object will contain information about the
         // response from the server, including the ID of the created 
         // resource, the OperationOutcome response, etc. (assuming that
         // any of these things were provided by the server! They may not
         // always be)
         IdDt id = (IdDt) outcome.getId();
         System.out.println(&quot;Got ID: &quot; + id.getValue());
</pre> 
  </div> 
  <div class="section"> 
   <h4 id="Conditional_Creates">Conditional Creates</h4> 
   <p> FHIR also specifies a type of update called &quot;conditional create&quot;, where a set of search parameters are provided and a new resource is only created if no existing resource matches those parameters. See the FHIR specification for more information on conditional creation. </p> 
   <div class="source"> 
    <pre>          // One form
          MethodOutcome outcome = client.create()
                  .resource(patient)
                  .conditionalByUrl(&quot;Patient?identifier=system%7C00001&quot;)
                  .execute();

          // Another form
          MethodOutcome outcome2 = client.create()
                  .resource(patient)
                  .conditional()
                  .where(Patient.IDENTIFIER.exactly().systemAndIdentifier(&quot;system&quot;, &quot;00001&quot;))
                  .execute();

          // This will return Boolean.TRUE if the server responded with an HTTP 201 created,
          // otherwise it will return null.
          Boolean created = outcome.getCreated();

          // The ID of the created, or the pre-existing resource
          IdDt id = (IdDt) outcome.getId();
</pre> 
   </div> 
  </div> 
 </div> 
 <div class="section"> 
  <h3 id="ReadVRead_-_Instance">Read/VRead - Instance</h3> 
  <p> Given a resource name and ID, it is simple to retrieve the latest version of that resource (a 'read') </p> 
  <div class="source"> 
   <pre>// search for patient 123
Patient patient = client.read()
                        .resource(Patient.class)
                        .withId(&quot;123&quot;)
                        .execute(); 
</pre> 
  </div> 
  <p> By adding a version string, it is also possible to retrieve a specific version (a 'vread') </p> 
  <div class="source"> 
   <pre>// search for patient 123 (specific version 888)
Patient patient = client.read()
                        .resource(Patient.class)
                        .withIdAndVersion(&quot;123&quot;, &quot;888&quot;)
                        .execute(); 
</pre> 
  </div> 
  <p> It is also possible to retrieve a resource given its absolute URL (this will override the base URL set on the client) </p> 
  <div class="source"> 
   <pre>// search for patient 123 on example.com
String url = &quot;http://example.com/fhir/Patient/123&quot;;
Patient patient = client.read()
                        .resource(Patient.class)
                        .withUrl(url)
                        .execute(); 
</pre> 
  </div> 
  <p> <b>See also</b> the page on <a href="./doc_rest_etag.html#client_read">ETag Support</a> for information on specifying a matching version in the client request. </p> 
 </div> 
 <div class="section"> 
  <h3 id="Delete_-_Instance">Delete - Instance</h3> 
  <p> The following example shows how to perform a delete operation using the generic client: </p> 
  <div class="source"> 
   <pre>          IBaseOperationOutcome resp = client.delete().resourceById(new IdDt(&quot;Patient&quot;, &quot;1234&quot;)).execute();

         // outcome may be null if the server didn't return one
          if (resp != null) {
              OperationOutcome outcome = (OperationOutcome) resp;
            System.out.println(outcome.getIssueFirstRep().getDetailsElement().getValue());
         }
</pre> 
  </div> 
  <div class="section"> 
   <h4 id="Conditional_Deletes">Conditional Deletes</h4> 
   <p> Conditional deletions are also possible, which is a form where instead of deleting a resource using its logical ID, you specify a set of search criteria and a single resource is deleted if it matches that criteria. Note that this is not a mechanism for bulk deletion; see the FHIR specification for information on conditional deletes and how they are used. </p> 
   <div class="source"> 
    <pre>           client.delete()
                   .resourceConditionalByUrl(&quot;Patient?identifier=system%7C00001&quot;)
                   .execute();

           client.delete()
                   .resourceConditionalByType(&quot;Patient&quot;)
                   .where(Patient.IDENTIFIER.exactly().systemAndIdentifier(&quot;system&quot;, &quot;00001&quot;))
                   .execute();
</pre> 
   </div> 
  </div> 
 </div> 
 <div class="section"> 
  <h3 id="Update_-_Instance">Update - Instance</h3> 
  <p> Updating a resource is similar to creating one, except that an ID must be supplied since you are updating a previously existing resource instance. </p> 
  <p> The following example shows how to perform an update operation using the generic client: </p> 
  <div class="source"> 
   <pre>         Patient patient = new Patient();
         // ..populate the patient object..
         patient.addIdentifier().setSystem(&quot;urn:system&quot;).setValue(&quot;12345&quot;);
         patient.addName().addFamily(&quot;Smith&quot;).addGiven(&quot;John&quot;);

         // To update a resource, it should have an ID set (if the resource
         // object
         // comes from the results of a previous read or search, it will already
         // have one though)
         patient.setId(&quot;Patient/123&quot;);

         // Invoke the server update method
         MethodOutcome outcome = client.update()
            .resource(patient)
            .execute();

         // The MethodOutcome object will contain information about the
         // response from the server, including the ID of the created 
         // resource, the OperationOutcome response, etc. (assuming that
         // any of these things were provided by the server! They may not
         // always be)
         IdDt id = (IdDt) outcome.getId();
         System.out.println(&quot;Got ID: &quot; + id.getValue());
</pre> 
  </div> 
  <div class="section"> 
   <h4 id="Conditional_Updates">Conditional Updates</h4> 
   <p> FHIR also specifies a type of update called &quot;conditional updates&quot;, where insetad of using the logical ID of a resource to update, a set of search parameters is provided. If a single resource matches that set of parameters, that resource is updated. See the FHIR specification for information on how conditional updates work. </p> 
   <div class="source"> 
    <pre>          client.update()
                  .resource(patient)
                  .conditionalByUrl(&quot;Patient?identifier=system%7C00001&quot;)
                  .execute();

          client.update()
                  .resource(patient)
                  .conditional()
                  .where(Patient.IDENTIFIER.exactly().systemAndIdentifier(&quot;system&quot;, &quot;00001&quot;))
                  .execute();
</pre> 
   </div> 
  </div> 
  <div class="section"> 
   <h4 id="ETags_and_Resource_Contention">ETags and Resource Contention</h4> 
   <p> <b>See also</b> the page on <a href="./doc_rest_etag.html#client_update">ETag Support</a> for information on specifying a matching version in the client request. </p> 
  </div> 
 </div> 
 <div class="section"> 
  <h3 id="History_-_ServerTypeInstance">History - Server/Type/Instance</h3> 
  <p> To retrieve the version history of all resources, or all resources of a given type, or of a specific instance of a resource, you call the <tt>history()</tt> method. </p> 
  <div class="source"> 
   <pre>response = client
   .history()
   .onServer()
   .andReturnDstu1Bundle()
   .execute();
</pre> 
  </div> 
  <p> If you are using a DSTU2 compliant server, you should instead use the Bundle resource which is found in the DSTU2 structures JAR, as shown in the syntax below. Note that in both cases, the class name is <tt>Bundle</tt>, but the DSTU2 bundle is found in the <tt>.resources.</tt> package. </p> 
  <div class="source"> 
   <pre>response = client
   .history()
   .onServer()
   .andReturnBundle(ca.uhn.fhir.model.dstu2.resource.Bundle.class)
   .execute();
</pre> 
  </div> 
  <p> You can also optionally request that only resource versions later than a given date, and/or only up to a given count (number) of resource versions be returned. </p> 
  <div class="source"> 
   <pre>response = client
   .history()
   .onServer()
   .andReturnBundle(ca.uhn.fhir.model.dstu2.resource.Bundle.class)
   .since(new InstantDt(&quot;2012-01-01T12:22:32.038Z&quot;))
   .count(100)
   .execute();
</pre> 
  </div> 
 </div> 
 <div class="section"> 
  <h3 id="Transaction_-_Server">Transaction - Server</h3> 
  <p> The following example shows how to execute a transaction using the generic client: </p> 
  <div class="source"> 
   <pre>         List&lt;IResource&gt; resources = new ArrayList&lt;IResource&gt;();
         // .. populate this list - note that you can also pass in a populated
         // Bundle if you want to create one manually ..

         List&lt;IBaseResource&gt; response = client.transaction().withResources(resources).execute();
</pre> 
  </div> 
 </div> 
 <div class="section"> 
  <h3 id="Conformance_-_Server">Conformance - Server</h3> 
  <p> To retrieve the server's conformance statement, simply call the <tt>conformance()</tt> method as shown below. </p> 
  <div class="source"> 
   <pre>// Retrieve the server's conformance statement and print its
// description
Conformance conf = client.fetchConformance().ofType(Conformance.class).execute();
System.out.println(conf.getDescriptionElement().getValue());
</pre> 
  </div> 
 </div> 
</div> 
<div class="section"> 
 <h2 id="Extended_Operations">Extended Operations</h2> 
 <p> In the FHIR DSTU2 version, operations (referred to as &quot;extended operations&quot;) were added. These operations are an RPC style of invocation, with a set of named input parameters passed to the server and a set of named output parameters returned back. </p> 
 <p> To invoke an operation using the client, you simply need to create the input <a href="./apidocs-dstu2/ca/uhn/fhir/model/dstu2/resource/Parameters.html">Parameters</a> resource, then pass that to the <tt>operation()</tt> fluent method. </p> 
 <p> The example below shows a simple operation call. </p> 
 <div class="source"> 
  <pre>// Create a client to talk to the HeathIntersections server
FhirContext ctx = FhirContext.forDstu2();
IGenericClient client = ctx.newRestfulGenericClient(&quot;http://fhir-dev.healthintersections.com.au/open&quot;);
client.registerInterceptor(new LoggingInterceptor(true));

// Create the input parameters to pass to the server
Parameters inParams = new Parameters();
inParams.addParameter().setName(&quot;start&quot;).setValue(new DateDt(&quot;2001-01-01&quot;));
inParams.addParameter().setName(&quot;end&quot;).setValue(new DateDt(&quot;2015-03-01&quot;));

// Invoke $everything on &quot;Patient/1&quot;
Parameters outParams = client
   .operation()
   .onInstance(new IdDt(&quot;Patient&quot;, &quot;1&quot;))
   .named(&quot;$everything&quot;)
   .withParameters(inParams)
   .useHttpGet() // Use HTTP GET instead of POST
   .execute();
</pre> 
 </div> 
 <p> Note that if the operation does not require any input parameters, you may also invoke the operation using the following form. Note that the <tt>withNoParameters</tt> still requires you to provide the type of the Parameters resource so that it can return the correct type in the response. </p> 
 <div class="source"> 
  <pre>// Create a client to talk to the HeathIntersections server
FhirContext ctx = FhirContext.forDstu2();
IGenericClient client = ctx.newRestfulGenericClient(&quot;http://fhir-dev.healthintersections.com.au/open&quot;);
client.registerInterceptor(new LoggingInterceptor(true));

// Invoke $everything on &quot;Patient/1&quot;
Parameters outParams = client
   .operation()
   .onInstance(new IdDt(&quot;Patient&quot;, &quot;1&quot;))
   .named(&quot;$everything&quot;)
   .withNoParameters(Parameters.class) // No input parameters
   .execute();
</pre> 
 </div> 
 <div class="section"> 
  <h3 id="Using_the_HTTP_GET_Form">Using the HTTP GET Form</h3> 
  <p> By default, the client will invoke operations using the HTTP POST form. The FHIR specification also allows requests to use the HTTP GET verb if the operation is idempotent and has no composite/resource parameters. Use the following form to invoke operation with HTTP GET. </p> 
  <div class="source"> 
   <pre>// Create a client to talk to the HeathIntersections server
FhirContext ctx = FhirContext.forDstu2();
IGenericClient client = ctx.newRestfulGenericClient(&quot;http://fhir-dev.healthintersections.com.au/open&quot;);
client.registerInterceptor(new LoggingInterceptor(true));

// Create the input parameters to pass to the server
Parameters inParams = new Parameters();
inParams.addParameter().setName(&quot;start&quot;).setValue(new DateDt(&quot;2001-01-01&quot;));
inParams.addParameter().setName(&quot;end&quot;).setValue(new DateDt(&quot;2015-03-01&quot;));

// Invoke $everything on &quot;Patient/1&quot;
Parameters outParams = client
   .operation()
   .onInstance(new IdDt(&quot;Patient&quot;, &quot;1&quot;))
   .named(&quot;$everything&quot;)
   .withParameters(inParams)
   .useHttpGet() // Use HTTP GET instead of POST
   .execute();
</pre> 
  </div> 
 </div> 
 <div class="section"> 
  <h3 id="Built-In_Operations_-_Validate">Built-In Operations - Validate</h3> 
  <p> The $validate operation asks the server to test a given resource to see if it would be acceptable as a create/update on that server. The client has built-in support for this operation. </p> 
  <p class="doc_info_bubble"> If the client is in DSTU1 mode, the method below will invoke the DSTU1 validation style instead. </p> 
  <div class="source"> 
   <pre>Patient patient = new Patient();
patient.addIdentifier().setSystem(&quot;http://hospital.com&quot;).setValue(&quot;123445&quot;);
patient.addName().addFamily(&quot;Smith&quot;).addGiven(&quot;John&quot;);

// Validate the resource
MethodOutcome outcome = client.validate()
   .resource(patient)
   .execute();

// The returned object will contain an operation outcome resource
OperationOutcome oo = (OperationOutcome) outcome.getOperationOutcome();

// If the OperationOutcome has any issues with a severity of ERROR or SEVERE,
// the validation failed.
for (Issue nextIssue : oo.getIssue()) {
   if (nextIssue.getSeverityElement().getValueAsEnum().ordinal() &gt;= IssueSeverityEnum.ERROR.ordinal()) {
      System.out.println(&quot;We failed validation!&quot;);
   }
}
</pre> 
  </div> 
 </div> 
</div>
			</div>
		</div>
		<div class="span4">
			<div id="toc-sidebar">
				<div class="well">
					<ul class="nav nav-list">
						<li class="nav-header">Table of Contents</li>
		<li><a href="#Creating_a_RESTful_Client" title="Creating a RESTful Client">Creating a RESTful Client</a>
		<li class="dropdown"><a href="#The_FluentGeneric_Client" title="The Fluent/Generic Client">The Fluent/Generic Client <b class="caret"></b></a>
			<ul class="nav nav-list">
		<li><a href="#Fluent_Calls" title="Fluent Calls">Fluent Calls</a>
		<li class="dropdown"><a href="#SearchQuery_-_Type" title="Search/Query - Type">Search/Query - Type <b class="caret"></b></a>
			<ul class="nav nav-list">
		<li><a href="#Search_-_Multi-valued_Parameters_ANYOR" title="Search - Multi-valued Parameters (ANY/OR)">Search - Multi-valued Parameters (ANY/OR)</a>
		<li><a href="#Search_-_Multi-valued_Parameters_ALLAND" title="Search - Multi-valued Parameters (ALL/AND)">Search - Multi-valued Parameters (ALL/AND)</a>
		<li><a href="#Search_-_Paging" title="Search - Paging">Search - Paging</a>
		<li><a href="#Search_-_Composite_Parameters" title="Search - Composite Parameters">Search - Composite Parameters</a>
		<li><a href="#Search_-_By_plain_URL" title="Search - By plain URL">Search - By plain URL</a>
		<li><a href="#Search_-_Other_Query_Options" title="Search - Other Query Options">Search - Other Query Options</a>
		<li><a href="#Search_-_Using_HTTP_POST" title="Search - Using HTTP POST">Search - Using HTTP POST</a>
		<li><a href="#Search_-_Compartments" title="Search - Compartments">Search - Compartments</a>
		<li><a href="#Search_-_Subsetting__summary_and__elements" title="Search - Subsetting (_summary and _elements)">Search - Subsetting (_summary and _elements)</a>
				<li class="divider"></li>
			</ul>
		</li>
		<li class="dropdown"><a href="#Create_-_Type" title="Create - Type">Create - Type <b class="caret"></b></a>
			<ul class="nav nav-list">
		<li><a href="#Conditional_Creates" title="Conditional Creates">Conditional Creates</a>
				<li class="divider"></li>
			</ul>
		</li>
		<li><a href="#ReadVRead_-_Instance" title="Read/VRead - Instance">Read/VRead - Instance</a>
		<li class="dropdown"><a href="#Delete_-_Instance" title="Delete - Instance">Delete - Instance <b class="caret"></b></a>
			<ul class="nav nav-list">
		<li><a href="#Conditional_Deletes" title="Conditional Deletes">Conditional Deletes</a>
				<li class="divider"></li>
			</ul>
		</li>
		<li class="dropdown"><a href="#Update_-_Instance" title="Update - Instance">Update - Instance <b class="caret"></b></a>
			<ul class="nav nav-list">
		<li><a href="#Conditional_Updates" title="Conditional Updates">Conditional Updates</a>
		<li><a href="#ETags_and_Resource_Contention" title="ETags and Resource Contention">ETags and Resource Contention</a>
				<li class="divider"></li>
			</ul>
		</li>
		<li><a href="#History_-_ServerTypeInstance" title="History - Server/Type/Instance">History - Server/Type/Instance</a>
		<li><a href="#Transaction_-_Server" title="Transaction - Server">Transaction - Server</a>
		<li><a href="#Conformance_-_Server" title="Conformance - Server">Conformance - Server</a>
				<li class="divider"></li>
			</ul>
		</li>
		<li class="dropdown"><a href="#Extended_Operations" title="Extended Operations">Extended Operations <b class="caret"></b></a>
			<ul class="nav nav-list">
		<li><a href="#Using_the_HTTP_GET_Form" title="Using the HTTP GET Form">Using the HTTP GET Form</a>
		<li><a href="#Built-In_Operations_-_Validate" title="Built-In Operations - Validate">Built-In Operations - Validate</a>
				<li class="divider"></li>
			</ul>
		</li>
					</ul>
				</div>
			</div>
		</div>
	</div>
	</div>

	</div><!-- /container -->

	<!-- Footer
	================================================== -->
	<footer class="well">
		<div class="container">
			<div class="row">
				<div class="span2 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">HAPI FHIR</li>
						<li >
							<a href="index.html" title="Home">Home</a>
						</li>
						<li >
							<a href="download.html"  title="Download"><i class="fa fa-download"></i> Download</a>
						</li>
						<li >
							<a href="changes-report.html" title="Changelog">Changelog</a>
						</li>
						<li >
							<a href="license.html" title="License">License</a>
						</li>
						<li class="nav-header">Test Server</li>
						<li >
							<a href="http://fhirtest.uhn.ca" title="Public Test Server" class="externalLink">Public Test Server</a>
						</li>
						<li >
							<a href="doc_vagrant.html" title="Vagrant Private Test Server">Vagrant Private Test Server</a>
						</li>
					</ul>
				</div>
				<div class="span2 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Using HAPI</li>
						<li >
							<a href="docindex.html" title="Documentation Index">Documentation Index</a>
						</li>
						<li >
							<a href="doc_cli.html" title="Command Line Tool (cli)">Command Line Tool (cli)</a>
						</li>
						<li class="nav-header">Contribute</li>
						<li >
							<a href="hacking_hapi_fhir.html" title="Guide to Hacking HAPI">Guide to Hacking HAPI</a>
						</li>
					</ul>
				</div>
				<div class="span2 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">JavaDocs</li>
						<li >
							<a href="apidocs/index.html" title="Core API">Core API</a>
						</li>
						<li >
							<a href="apidocs-dstu/index.html" title="Model API (DSTU1)">Model API (DSTU1)</a>
						</li>
						<li >
							<a href="apidocs-dstu2/index.html" title="Model API (DSTU2)">Model API (DSTU2)</a>
						</li>
						<li >
							<a href="apidocs-dstu3/index.html" title="Model API (DSTU3)">Model API (DSTU3)</a>
						</li>
						<li >
							<a href="apidocs-jpaserver/index.html" title="JPA Server API">JPA Server API</a>
						</li>
						<li class="nav-header">JXR</li>
						<li >
							<a href="xref-base/index.html" title="Core">Core</a>
						</li>
						<li >
							<a href="xref-jpaserver/index.html" title="JPA Server">JPA Server</a>
						</li>
					</ul>
				</div>
				<div class="span3 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Get Help</li>
						<li >
							<a href="https://groups.google.com/d/forum/hapi-fhir" title="Google Group (Ask Questions)" class="externalLink">Google Group (Ask Questions)</a>
						</li>
						<li >
							<a href="issues" title="Issue Tracker (Report Bugs/Request Features)">Issue Tracker (Report Bugs/Request Features)</a>
						</li>
						<li >
							<a href="hapi-fhir-faq.html" title="Frequently Asked Questions (FAQ)">Frequently Asked Questions (FAQ)</a>
						</li>
					</ul>
				</div>
				<div class="span3 bottom-description">
					<blockquote>HAPI FHIR is a Java implementation of the HL7 FHIR
				(Fast Healthcare Interoperable Resources) specification.
				This project is open source (licensed under the Apache Software
				License 2.0) and 100% free to use.<br/><br/>
				<a href="https://github.com/jamesagnew/hapi-fhir"><img src="./images/github-logo-mini.png" alt="Hosted on GitHub" border="0"/></a>
				<br/>
				Star us and we will love you!<br />
				<iframe src="https://ghbtns.com/github-btn.html?user=jamesagnew&repo=hapi-fhir&type=star&count=true" frameborder="0" scrolling="0" width="100px" height="20px"></iframe></blockquote>
				</div>
			</div>
		</div>
	</footer>

	<div class="container subfooter">
		<div class="row">
			<div class="span12">
				<p class="pull-right"><a href="#">Back to top</a></p>
				<p class="copyright">Copyright &copy;2014-2016 <a href="http://www.uhn.ca">University Health Network</a>. All Rights Reserved.</p>
				<p><a href="http://github.com/andriusvelykis/reflow-maven-skin" title="Reflow Maven skin">Reflow Maven skin</a> by <a href="http://andrius.velykis.lt" target="_blank" title="Andrius Velykis">Andrius Velykis</a>.</p>
			</div>
		</div>
	</div>

	<!-- Le javascript
	================================================== -->
	<!-- Placed at the end of the document so the pages load faster -->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>

	<script src="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
	<script src="./js/lightbox.min.js"></script>
	<script src="./js/reflow-scroll.js"></script>

	<script src="./js/reflow-skin.js"></script>

	<script type="text/javascript">
	var elements = document.getElementsByClassName("source");
	for (var i=0; i < elements.length; i++) {
		var pres = elements[i].getElementsByTagName("pre");
		for (var j = 0; j < pres.length; j++) {
			var pre = pres[j];
			if (pre.innerHTML.match(/^\s*\&lt\;/)) {
				pre.className = 'brush: xml';
			} else if (pre.innerHTML.match(/\/\*/)) {
				pre.className = 'brush: java';
			} else if (pre.innerHTML.match(/^\/\//)) {
				pre.className = 'brush: java';
			} else if (pre.innerHTML.match(/^\{/)) {
				pre.className = 'brush: jscript';
			} else if (pre.innerHTML.match(/^\#/)) {
				pre.className = 'brush: bash';
			} else if (pre.innerHTML.match(/\&lt\;\//)) {
				pre.className = 'brush: xml';
			} else {
				pre.className = 'brush: java';
			}
		}
	}

	SyntaxHighlighter.all();
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-1395874-5', 'auto');
  ga('require', 'displayfeatures');
  ga('require', 'linkid', 'linkid.js');
  ga('send', 'pageview');

</script>
                </body >
</html>